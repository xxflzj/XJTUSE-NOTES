[TOC]

#  [XJTU计算机网络安全与管理]——第10讲 安全应用及协议（一）

## 一、概述

现有的各种网络协议是通过不同的协议实现的：（如SMTP，TELNET，FTP，HTTP等）。

要实现网络安全应用，相应的协议除了要具有正常的功能外，还应具有安全功能。

> 协议设计中结合安全应用以实现
>
> 不同的协议层实现不同的安全功能。低层协议通过对上层协议的内容进行加密封装，保证上层协议传输内容的安全。
>
> 低层安全并不能完全保证高层应用安全：
>
> > 例：Email中的有害附件

IPsec：由IETF制定的一个网络层安全标准，使得不同的应用、**网络可以在Internet上构成虚拟的专网（VPN）**，并可安全的传输。

安全套接字（SSL/TSL）:Netscape提出，用于进行安全传输连接，目前主要用于对Web网站的安全访问。

安全域名服务（DNSSEC）：是一个Internet草案，解决分布式域名系统的安全性

安全电子邮件：PGP与S/MIME

SSH：用于安全远程登录、文件传输标准

公钥加密标准：（PKCS）

IEEE P1363:公钥加密标准。

通用安全服务API（GSSAPI）

安全电子交易（SET）

![image-20220613094423987](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/image-20220613094423987.png)

## 二、安全应用协议—邮件安全

电子邮件是目前最为广泛使用的网络服务之一

通常的电子邮件服务并非安全：

> 可在传输过程中检验其完整性
>
> 通过检验发件人在目的系统中的权限进行保障

安全电子邮件所要达到的目的主要是增强：

> 机密性：防泄漏
>
> 鉴别：消息发送方
>
> 完整性：消息未被更改
>
> 非否认：保证发送方无法抵赖

### PGP|Pretty Good Privacy

是一种广泛使用的安全电子邮件实例

由Phil Zimmermann开发

选择了最好的可用密码算法（MD5，SHA-1，IDEA，3DES，RSA等）并将它们集中在一个程序中

在Unix，pc，Macintosh等系统上都有应用

最早是开源的，但也有商业应用

PGP的操作：<mark>**鉴别；机密性 ；压缩；电子邮件的兼容性；分段和重装**</mark>——掌握

#### PGP 操作-鉴别（认证）

![image-20220613100340287](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/image-20220613100340287.png)

- 发送方创建消息
- 使用SHA-1生成160-bit消息哈希值
- 使用发送方的私钥对该哈希值进行RSA签名
- 接收方利用发送方的RSA公钥解密并恢复哈希值
- 接受方计算消息的哈希值并与解密的哈希值对比

#### PGP 操作-机密性保证

![image-20220613100312338](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/image-20220613100312338.png)

- 发送方生成128-bit的随机数作为所创建消息的会话密钥
- 结合会话密钥使用CAST-128/IDEA/3DES与CBC模式对消息加密
- 会话密钥通过使用接受者的RSA公钥加密并随消息发出
- 接受者使用其RSA解密并恢复会话密钥
- 会话密钥被用来恢复消息

#### PGP-机密性与鉴别

![image-20220613100805673](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/image-20220613100805673.png)

- 可以将两种服务使用在同一个消息上
- 创建签名&追加在消息后
- 加密消息&签名
- 利用RSA/ElGmal加密会话密钥

#### PGP 操作-压缩

默认情况下PGP在签名后加密前会进行压缩

> 节省传送与存储空间
>
> 相当于经过了一次变换，抗明文攻击的能力更强

使用ZIP压缩算法

#### PGP-Email兼容性

当使用PGP时将会传送二进制数据（加密）

然而email仅仅是为文本而设计因此PGP必须将原始的二进制数据编码为**可打印的ASCII字符**

使用 radix-64算法（就是MIME的BASE 64格式 ）

> 将三个字节映射到4个可打印的字符
>
> 同样适用CRC

当消息过大时PGP将采用分组

#### 四种服务的关系

![image-20220613101002581](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/image-20220613101002581.png)

#### PGP报文格式——掌握

![image-20220613132232317](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/image-20220613132232317.png)

#### PGP会话密钥

每条消息均需要一个会话密钥

> 大小不同：56-bit DES，168-bitTriple-DES，128-bitIDEA等

使用ANSI X12.17模式生成

结合上次的使用与用户当前的击键生成随机输入

#### PGP公钥与私钥

由于有可能有多个公钥/私钥被用到需要确认到底一条消息使用的是那个密钥加密的会话密钥

基于不同的密钥，使用其密钥标识符

> 一个密钥最低的64bit
>
> 基本上可说是独一无二的

**密钥标识符同样也用在签名中**

#### PGP密钥环

每个PGP用户拥有一对密钥环

> 公钥环包括该用户所知的所有的PGP用户的公钥。通过Key ID索引
>
> 私钥环包括该用户自己的公/私钥。

私钥的安全性基于口令短语

#### PGP消息产生与接收

发送消息的PGP实体执行步骤：签名，加密

![image-20220613102036376](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/image-20220613102036376.png)

接收消息的PGP实体执行步骤：揭秘消息，认证消息

![image-20220613102054712](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/image-20220613102054712.png)

#### PGP密钥管理

不同于依赖CA

<mark>PGP**每个用户拥有自己的**CA</mark>

> 可以直接签名密钥给他知道的用户

基于“信任网络”

> 可信的密钥是被签过名的
>
> 可以信任那些被其他人签名的密钥，若有签名链通到他们

用户可以废除他们的密钥

### S/MIME——不用看

是MIME邮件的安全增强

> 原始的RFC822中Email仅仅是text
>
> MIME提供了不同正文类型与附件的支持
>
> 将二进制数据转化为textual形式
>
> S/MIME提供了安全性增强

目前有很多邮件客户端均支持该协议

> Outlook，Mozilla，MacMail

#### S/MIME功能

封装的数据：结合相关密钥加密正文与密钥

签名的数据：对内容摘要并进行签名，再进行radix-64编码

清澈签名（Clear-signed）的数据：形成内容的数字签名，但只对签名使用radix-64签名

签名并加密的数据：只签名与只加密的数据可以递归使用

#### 算法

数字签名：DSS&RSA

哈希函数：SHA-1与MD5

会话密钥加密：ElGamal&RSA

消息加密：AES，Triple-DES

MAC：HMAC（使用SHA-1)

有相关步骤决定用什么算法

#### 证书

使用X509 V3证书

管理实用X。509结构与pgp信任网

每个用户有信任CA‘s证书

有自己的公/私钥环

证书必须被信任CA签名

有几个著名的CA

> Verisign最广泛使用
>
> VeriSign有不同级别的安全类型

#### PGP与SMIME

**它的认证机制依赖于层次结构的证书认证机构**，所有下一级的组织和个人的证书由上一级的组织负责认证，而最上一级的组织（根证书）之间相互认证，整个信任关系基本是树状的，这就是所谓的Tree of Trust。

S/MIME将信件内容加密签名后作为特殊的附件传送，它的证书格式采用X.509，但与一般浏览器网上使用的SSL证书有一定差异。

## 三、安全域名服务DNSSEC

Dns是Internet核心服务之一，提供域名到ip的转换

Dns易受到攻击

> **查询错误**
>
> **辅助域名服务复制数据时错误**
>
> **缓冲溢出**
>
> **拒绝服务**

DNSSEC由IETF提出，增加了新的资源记录类型可以对域名数据的来源进行认证，保证完整性

> 资源记录(SIG,KEY,DS,NXT)
>
> 消息头部(CD,AD)

DNSSEC增加了四种新的资源记录（SIG,KEY,DS,NXT)其中前三项是与公钥算法有关的

> KEY记录（用于放认证签名的公钥）
>
> SIG记录存放对域名数据的数据签名
>
> NXT记录用于保证域名数据的内部一致性
>
> DS记录用于建立认证链的指针

**DNSSEC中的认证**

> AD（认证数据）位说明dns应答包中的所有数据都被服务器按照自己的策略认证过
>
> CD（禁止检查）位表明待认证数据对于解析器的查询来说是可以接受的
>
> **认证链**

## 参考资料

[1] 西安交通大学计算机网络安全与管理2022年春PPT 	田暄

[2] https://www.docin.com/p-609787098.html